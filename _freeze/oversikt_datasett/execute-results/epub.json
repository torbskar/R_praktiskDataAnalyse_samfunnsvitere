{
  "hash": "97569fde9af5a64e7f1c489e9bf7137b",
  "result": {
    "engine": "knitr",
    "markdown": "# Få oversikt over datasettet\n\n\n::: {.cell}\n\n:::\n\n\nNår man jobber med datasett kan det være mange variable, og det er viktig å ha en oversikt over datasettet. Bare det å finne riktig variabel kan være en utfordring i større datasett. Det vil normalt følge med et dokumentasjonsnotat eller -rapport med oversikt over alle variable. Ofte vil det være mest hensiktsmessig å slå opp i denne, men vi kan også ha behov for å se nærmere på dataene i R. En første ting man bør sjekke er om dataene er lest inn riktig og at det rett og slett ser greit ut.\n\nI det følgende bruker vi datasettet `wagepan` som er paneldata om lønn fra pakken `wooldridge`. Datasettet inneholder informasjon om arbeidstakere over flere år.\n\n## Sjekk om innlesning ble riktig\nDet første man bør sjekke er jo om innlesning av datasettet ble riktig. Skjer det noe feil her, så blir selvsagt alt annet feil. Men det er lite som kan gå galt når man leser inn fra datasett. Et unntak er csv-filer som ikke har metadata inkludert.\n\nFunksjonen `class()` gir informasjon om hva slags objekt man har. Altså: etter at man har lest inn dataene og lagt det i et objekt. Her sjekkes objektet *wagepan*:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(wagepan)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n```\n\n\n:::\n:::\n\nI dette tilfellet får vi tre beskjeder. Det er en kombinert objekttype av *tibble* og *data.frame*. Mens *data.frame* er standard datasett tilsvarende som et regneark, så er *tibble* en utvidelse med noen ekstra funksjoner som er nyttige for avanserte brukere, men er å regne som en utvidelse av *data.frame*. For vårt formål vil det i praksis være det samme. Et datasett som leses inn i R bør altså være av typen tbl eller data.frame. Data kan også ha andre typer strukturer og da vil `class()` rapportere noe annet.\n\nNår man bruker funksjoner i R, så vil noen ganger resultatet avhenge av hva slags type objekt det er.\n\nFor å vite hvor mange rader og kolonner det er i datasettet kan man bruke funksjonen `dim()` slik:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(wagepan)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4360   10\n```\n\n\n:::\n:::\n\n\nHer får vi vite at det er 4360 rader (dvs. observasjoner) og 10 kollonner (dvs. variable).\n\n\n### Bruke `View()`\nSærlig når man er uvant med å jobbe i R vil man kunne ha behov for å *se på dataene* slik man er vant til fra regneark eller software som SPSS eller Stata. En mulighet er å bruke funksjonen `View()` så vil hele datafilen åpnes i eget vindu. Dette er kun egnet for å se på dataene og du kan lukke vinduet uten at det påvirker dataene. Dataene ligger fremdeles i det samme objektet på samme måte som før.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nView(wagepan)\n```\n:::\n\n\nHvis variablene ser ut til å ha forventede variabelnavn og verdier, så er det antakeligvis ok.\n\nEt slikt datasett tar imidlertid stor plass og det er vanligvis mer hensiktsmessige måter å se på dataene på som også gir mer informasjon. I R er det ikke meningen at du skal \"sitte og se på dataene\" på den måten mens man jobber. Men ta gjerne en titt for å få et bedre inntrykk av hvordan dataene ser ut.\n\nDu kan lukke det vinduet med dataene uten at det har noe å si for dataene, som fremdeles er tilgjengelig i minnet på datamaskinen på samme måte som før.\n\n\n### Bruke `head()`\n\nFunksjonen `head()` skriver de første 6 observasjonenen til konsollen i Rstudio. Det gir et første inntrykk av datasettet med variabelnavn og de første verdiene uten å åpne hele datasettet. Hva som faktisk vises vil avhenge av hvor stor skjerm du har, men R vil bare vise de første variablene etter hva som er plass til på skjermen din. For datasett med mange variable er ikke dette veldig nyttig, men for datasett med noen få variable fungerer det greit.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(wagepan)\n```\n:::\n\n\nLegg merke til at under hvert variabelnavn er det en indikasjon på hva slags variabeltype det er. For eksempel betyr `<dbl>` at det er en numerisk variabel mens `<dbl+lbl>` indikerer at variabelen inneholder *labels*.\n\nDet er lite hensiktsmessig å vise alt i konsollen fordi det rett og slett ikke er plass. Nerst står det derfor angitt at det er flere variable som ikke vises og navnet på de første av disse.\n\n### Subset med klammeparenteser\n\nEn enkel løsning er å bare se på noen få variable om gangen. Med klammeparentes kan vi angi hvilke radnummer og kolonnenummer vi ønsker se på med følgende syntax: `datasett[rader, kolonner]` der altså komma skiller mellom rader og kolonner. Følgende eksempel viser hvordan man kan bruke `head()` for å vise de første observasjonene i datasettet med bare de første 5 variablene (altså: kollonne nr 1-5).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(wagepan[, 1:5])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n     nr  year hours lwage  educ\n  <dbl> <dbl> <dbl> <dbl> <dbl>\n1    13  1980  2672  1.20    14\n2    13  1981  2320  1.85    14\n3    13  1982  2940  1.34    14\n4    13  1983  2960  1.43    14\n5    13  1984  3071  1.57    14\n6    13  1985  2864  1.70    14\n```\n\n\n:::\n:::\n\nVi kan altså også angi både rader og kollonner på denne måten. Her er eksempel som viser første 3 rader og variabelnummer 5 til 8.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(wagepan[1:3, 5:8])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n   educ black  hisp married\n  <dbl> <dbl> <dbl>   <dbl>\n1    14     0     0       0\n2    14     0     0       0\n3    14     0     0       0\n```\n\n\n:::\n:::\n\n\n\nLegg merke til at under hvert variabelnavn står det en liten tekst, f.eks. <dbl> eller <S3: haven_labelled>. Det kan også stå andre ting. dbl betyr at det er en kontinuerlig variabel, mens haven_labelled betyr at det er labler til alle eller noe verdier i variabelen.\n\nVi skal primært jobbe med data som ikke er \"labelled\", men du vil noen ganger komme borti dette, spesielt hvis du importerer data fra andre statistikksoftware.\n\n### Bruke 'glimpse()'\n\nI tidligere kurs skal dere ha lært å bruke funksjonen `glimpse()`. Her er et eksempel:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(wagepan)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 4,360\nColumns: 10\n$ nr      <dbl> 13, 13, 13, 13, 13, 13, 13, 13, 17, 17, 17, 17, 17, 17, 17, 17…\n$ year    <dbl> 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1980, 1981, 19…\n$ hours   <dbl> 2672, 2320, 2940, 2960, 3071, 2864, 2994, 2640, 2484, 2804, 25…\n$ lwage   <dbl> 1.1975402, 1.8530600, 1.3444617, 1.4332134, 1.5681251, 1.69989…\n$ educ    <dbl> 14, 14, 14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13…\n$ black   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ hisp    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ married <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,…\n$ union   <dbl> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ exper   <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 4, 5, 6, 7, 8, 9, 10, 11, 4, 5, 6, 7, …\n```\n\n\n:::\n:::\n\n\nI denne output'en er den første kollonnen altså variabelnavnene, deretter er det en kollonne som viser hva slags type variabel det er, og deretter de første observasjonene på hver variabel slik at man får et inntrykk av hvordan det ser ut. `glimpse()` gir altså omtrent samme informasjon som `head()`, men er nok mer hensiktsmessig hvis mange variable.\n\n\n### Undersøke enkeltvariable med `codebook()` fra pakken {memisc}\nNoen ganger vil man ha litt mer informasjon om enkeltvariablene. Noen datasett vil komme med labler (omtalt annet sted) eller faktorvariable, som gjør at variablene inneholder både tallverdier og tekst.\n\n\nÅ få ut noe deskriptiv statistikk og se på fordelinger er da gjerne neste steg som vil bli behandlet i de etterfølgende kapitlene.\n\nMan vil klare seg greit med det vi har vist ovenfor. Men det finnes flere måter å gjøre det på. Pakken {memisc} inneholder en rekke funksjoner for å håndtere surveydata, som vi ikke skal gå nærmere inn på her. Men akkurat funksjonen `codebook()` gir litt mer informativt output enn `look_for()`.\n\nFor å bruke denne må du installere pakken først. I eksempelet nedenfor er pakken ikke lastet med library(), men angitt pakken direkte med `memisc::` først. Dette kan være nyttig hvis man ikke skal bruke noen andre funksjoner fra denne pakken.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmemisc::codebook(wagepan$married)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================================================================================\n\n   wagepan$married 'Married'\n\n--------------------------------------------------------------------------------\n\n   Storage mode: double\n\n        Min: 0.0000000\n        Max: 1.0000000\n       Mean: 0.4389908\n   Std.Dev.: 0.4962639\n```\n\n\n:::\n:::\n\n\nPoenget her er altså bare å få en penere output og litt deskriptiv statistikk samtidig.\n\n## Søke i datasettet etter variable\nFor å se nærmere på en variabel går an å bruke funksjonen `look_for()`, som primært er en søke-funksjon, men det gir også informasjon om variabelen.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlook_for(wagepan, \"married\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n pos variable label   col_type missing values\n 8   married  Married dbl      0             \n```\n\n\n:::\n:::\n\n\nI output fremgår det at variabelen `married` finnes i datasettet, hva slags type den er, og eventuelle labler.\n\nDet går også an å bare få ut variabel-label med funksjonen `var_label()` slik:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar_label(wagepan$married)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Married\"\n```\n\n\n:::\n:::\n\n\nFor å se labels på *verdiene* bruk **val_labels()**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nval_labels(wagepan$married)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n```\n\n\n:::\n:::\n\n\n\nAlle datasett skal komme med en dokumentasjon som sier hva hver variabel inneholder og hvilke verdier som finnes i hver variable, og hva de betyr. For datasett fra R-pakker finnes dokumentasjonen i hjelpesiden, som du finner med `?wagepan` eller `help(wagepan)`.\n\nDu kan søke i dokumentasjonen på samme måte som i andre filer, men det kan være litt knotete. Et godt alternativ er å søke direkte i datasettet. Funksjonen `look_for()` søker både i variabelnavn, verdier og labler. Her er et eksempel for hvordan finne variabler som inneholder ordet \"wage\". Du kan også søke på kortere eller lengre tekststrenger.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlook_for(wagepan, \"wage\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n pos variable label           col_type missing values\n 4   lwage    Log hourly wage dbl      0             \n```\n\n\n:::\n:::\n\n\nHer finner vi variabelen `lwage` som inneholder logaritmen av timelønn. Vi kan se nærmere på variabellabelen slik:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar_label(wagepan$lwage)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Log hourly wage\"\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "oversikt_datasett_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}