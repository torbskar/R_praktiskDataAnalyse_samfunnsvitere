{
  "hash": "88973a5b92d19bd312b61426fb93fd33",
  "result": {
    "engine": "knitr",
    "markdown": "# Empirisk eksempel\n\n\n::: {.cell}\n\n:::\n\n\nArtikkelen [\"Human Values and Retirement Experiences: a Longitudinal Analysis of Norwegian Data\"](https://link.springer.com/article/10.1007/s11205-021-02687-7) bruker data fra NorLAG, runde 2 og 3. I det som følger vil hovedresultatene fra denne studien replikeres. Stor takk til Morten Blekesaune som var meget velvillig til å dele script slik at reprodusering er praktisk mulig. \n\n\n\n## Utvalg av variable \nAlle variable er dokumentert på NorLAG sine sider, og i egen fil som følger med utdelt datasett \"kodebok.html\". \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n-- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --\nv dplyr     1.1.4     v readr     2.1.6\nv forcats   1.0.1     v stringr   1.6.0\nv ggplot2   4.0.1     v tibble    3.3.1\nv lubridate 1.9.4     v tidyr     1.3.2\nv purrr     1.2.1     \n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\ni Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(haven)\n\n\ninfilbane <- \"C:/Users/torbskar/OneDrive - Universitetet i Oslo/Dokumenter/Undervisning/SOS4020_forkurs/data2023/rOBH3y10/\"\n\n# Leser inn dta-fil, velger aktuelle variable og koder om missing-verdier til NA. \n# drop_na() sletter observasjoner med NA-verdier. Merk at dette gjøres for de variablene som er valgt ut i steget før. \nregister <- read_stata( paste0(infilbane, \"NorLAG-lengde-register.dta\"), encoding = \"utf-8\") %>% \n  select(ref_nr, year, \n         inpgivinnt, inwoverfor, inftryg, inwyrkinnt, inwoverfor,    # pensj_ft overf_ft penal_ft penuf_ft penin_ft \n         inkode217, inkode218 ) %>% \n  mutate(inpgivinnt = ifelse(inpgivinnt == 999999999, NA, inpgivinnt),\n         inwoverfor = ifelse(inwoverfor == 999999999, NA, inwoverfor),\n         inftryg = ifelse(inftryg == 999999999, NA, inftryg)) %>% \n  drop_na()\n```\n:::\n\n\n\n# Leser inn data. Bruker labelled for enklere oversettelse av stata-kode\nnorlag <- readRDS(\"data/norlag_labelled.rds\") %>% \n  select(ref_nr, round, iodeltakelse, iointervjuaar,  # ref_nr round  io_intervjuyr  \n         iofodselsaar, ioalder, iokjonn,              # io_ioalder  \n         wb007, wr004,                                # wb007 wr004\n         hcPCS12, starts_with(\"vahv\")                 # hcPCS12 va_bhv*\n         #vahvssen, vahvsstr, vahvsotc, vahvscon\n         ) %>% \n  filter(round > 1, iodeltakelse %in% c(1,3)) %>% \n  mutate(alder = as.numeric(ioalder), \n         satis = as.numeric(wb007)) %>% \n  mutate(ald10 = alder/10, \n         ald2 = ald10^2,\n         ald3 = ald10^3,\n         year = iointervjuaar) %>% \n  filter(alder < 86, satis < 15, wr004 <= 5, !is.na(wr004), !is.na(satis))  %>% \n  arrange(ref_nr, round, year) %>% \n  filter(complete.cases(.))  \n\n\n# Kobler på register, beholder bare treff på begge.\nnorlagreg <- merge(norlag, register, by = c(\"ref_nr\", \"year\") ) %>% \n  mutate(hcPCS12 = hcPCS12/10,\n         fyshel1 = hcPCS12) %>% \n  group_by(ref_nr) %>% \n  mutate(antobs = n()) %>%      # Filtrerer på de som har akkurat to observasjoner. Altså: deltar i begge runder. \n  filter(antobs == 2) %>% \n  select(-antobs) %>% \n  group_by(ref_nr) %>% \n  mutate(pensj_ft = mean(inftryg),    #\"Pensjoner folketrygden\"\n         overf_ft = mean(inwoverfor), #\"Overføringer i alt\"\n         penal_ft = mean(inkode217),  # \"Alderspensjon\"\n         penuf_ft = mean(inkode218),  # \"Uførepensjon\"\n         penin_ft = mean(inpgivinnt)  #\"Pensjonsgivende inntekt\"\n  )\n  \n\ndim(norlagreg)\n\nsummary(norlagreg$alder)\n\n# Utvalgsstørrelse og personer ####\nnorlagreg %>% \n  group_by(round) %>% \n  ungroup() %>% \n  summarise(personer = n_distinct(ref_nr), observasjoner = n())\n\ntable(is.na(norlagreg$satis))\n\n\n## Etablering av utvalg for analyse \n\n\n\n\n## Deskriptiv statistikk \n\n\n\n\n## En kommentar om reproduserbarhet \nDet er svært viktig at forskning lar seg reprodusere. I denne sammenhengen gjelder det å kunne reprodusere nøyaktig samme resultat på samme data, som er viktig for uavhengig ettergåelse og kvalitetskontroll. At reproduserbart script kan gjøres tilgjengelig er helt avgjørende, men også at data er tilgjengelig. I dette tilfellet har Morten Blekesaune vært meget velvillig delt script etter forespørsel. Han svarte på epost samme dag, noe som er et tydelig tegn på at han også hadde orden i sakene og visst godt hvor scriptet var. Sånn skal det være! \n\nData var vanskeligere. NorLAG er ikke åpne data og er ikke opp til forskeren å dele. Vi er derfor avhengig av at også Sikt har orden i sakene. NorLAG er publisert i flere versjoner der det har vært noen endringer underveis. Det ble derfor praktisk vanskelig å få etablert nøyaktig samme utvalg uten å også få nøyaktig samme datauttrekk utlevert. Hvis ikke dataleverandør kan gi nøyaktig samme data, så blir heller ikke scriptet nøyaktig reproduserbart. \n\nEn viktig side ved å dele scriptet er at det gjøres en del små valg i den faktiske analysen som typisk ikke fremgår med tilstrekkelig detaljgrad i forskningsartikkelen. \n\n\n### Replikering på uavhengige data\nMer generelt er det også viktig å kunne replikere *tilsvarende resultater* på andre data, men det har et litt annet formål. For slik replisering er det imidlertid også viktig å ha nøyaktig informasjon om hva som ble gjort i den opprinnelige studien og data er godt dokumentert. \n\n\n\n",
    "supporting": [
      "appendix_empirisk_eksempel_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}